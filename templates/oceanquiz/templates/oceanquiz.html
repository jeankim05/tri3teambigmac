{% extends "layouts/base.html" %}
{% set questions = questions %}

{#OBJECTIVES:#}
{#[IF] JSON LIST IS PARSED AND/OR CALLED#}
{#[THEN] QUESTIONS WILL BE DISPLAYED RANDOMLY BASED OFF OF THE QUESTIONS.JSON FILE#}
{#[IF] WRONG ANSWER IS CHOSEN, SUBTRACT 1 FROM 10#}
{#[IF] RIGHT ANSWER IS CHOSEN, DO NOT SUBTRACT#}
{#GOAL: to add high score container that allows the user to see their high score in comparison to others set#}
<!DOCTYPE>
{% block body %}
    <h1 class="center-block" style=" text-align:center; font-family: serif"> Ocean Quiz</h1>
    <h3 style="text-align: center;padding-left:25px; font-size: 25px">Welcome to our quiz! Click the corresponding letter to your answer to all the questions and then submit. This mini quiz will test you on common ocean facts. </h3>
{#    <h4 style="text-align: center; font-size: 20px">Correct Answers Show up in Green while incorrect answers show up in red. Scroll all the way down for results. Good luck!</h4>#}
{#    <div id="currentTime"></div>#}
{#    <div id="questionsDiv"></div>#}
{#    <script src="questions.js"></script>#}

    <style>
        body{
            font-size: 15px;
            font-family: baskerville;
            color: #333;
            background-color: lightskyblue;
        }
        .question{
            font-weight: 600;
            margin-left: 50px;
        }
        .answers {
            margin-bottom: 20px;
            margin-left: 100px;
        }
        .answers label{
            display: block;
        }
        #submit{

            font-family: sans-serif;
            font-size: 20px;
            background-color: blue;
            color: black;
            border: 0px;
            border-radius: 3px;
            padding: 12px 28px;
            cursor: pointer;
            margin-bottom: 20px;
            margin-left: 100px;
        }
        #submit:hover{
            background-color: lightpink;
        }

    </style>
{#    <p id='main'></p>#}
{#    <script type="text/javascript" src="oceanquiz/js/questions.js">#}
{#        import json#}
{#        f = open('oceanquiz/js/questions.js',)#}
{#        data = json.load(f)#}
{#        type(data)#}
    {#var mydata = JSON.parse(questions);#}
{##}
{#    </script>#}


<div>
    <div>
        <body>
        <!-- Link to highscores -->
        <a href="HighScores.html">View Highscores</a>
        <!-- This is a wrapper -->
        <div id="wrapper">
            <!-- Div for timer -->
            <div id="currentTime"></div>
            <!-- Div for quiz content -->
            <div id="questionsDiv">
                <h1>Coding Quiz Challenge</h1>
                <p>Try to answer the following code-related questions within the time limit. Keep in mind that incorrect
                    answers
                    will penalize your score/time by ten seconds!</p>
                <ul id="choicesUl"></ul>
                <!-- Buttons -->
                <button id="startTime">Start Quiz</button>
            </div>

        </div>


        </body>
{#        {% for i in range(questions|shuffle) %}#}
{#        {% for i in range(questions|length) %}#}
{#            <div class="py-2 h5" id={{ i + 1 }}><b>Q. {{ questions[i]["question"] }}</b></div>#}
{#            <div class="ml-md-3 ml-sm-3 pl-md-5 pt-sm-0 pt-3" id="options">#}
{#                <label class="options">#}
{#                    <input id="choice" type="radio" name="radio">#}
{#                    <span class="checkmark">{{ questions[i]["a"] }}</span>#}
{#                </label>#}
{#                <br>#}
{#                <label class="options">#}
{#                    <input id="choice" type="radio" name="radio">#}
{#                    <span class="checkmark">{{ questions[i]["b"] }}</span>#}
{#                </label>#}
{#                <br>#}
{#                <label class="options">#}
{#                    <input id="choice" type="radio" name="radio">#}
{#                    <span class="checkmark">{{ questions[i]["c"] }}</span>#}
{#                </label>#}
{#                <br>#}
{#                <label class="options">#}
{#                    <input id="choice" type="radio" name="radio">#}
{#                    <span class="checkmark">{{ questions[i]["d"] }}</span>#}
{#                </label>#}
{#            </div>#}
{#    </div>#}
{#</div>#}
{#        {% endfor %}#}
{#<button id="submit">Submit Answers</button>#}
    <script>
var qDiv = document.querySelector("#qDiv");
var score = 10;

load(qIndex); //initiate quiz

function load(qIndex) {
    questionDiv.innerHTML = "";
    for (var i = 0; i < {{ questions|length }}; i++)
        var question = {{ questions[qIndex].question }}
        var choiceA = {{ questions[qIndex].a }}
        var choiceB = {{ questions[qIndex].b }}
        var choiceC = {{ questions[qIndex].c }}
        var choiceD = {{ questions[qIndex].d }}
        qDiv.textContent = question;
    choiceA.forEach(function (newItem) {
        var listItem = document.createElement("li");
        listItem.textContent = newItem;
        qDiv.appendChild(ulCreate);
        ulCreate.appendChild(listItem);
        listItem.addEventListener("click", (compare));
    })
    choiceB.forEach(function (newItem) {
        var listItem = document.createElement("li");
        listItem.textContent = newItem;
        qDiv.appendChild(ulCreate);
        ulCreate.appendChild(listItem);
        listItem.addEventListener("click", (compare));
    })
    choiceC.forEach(function (newItem) {
        var listItem = document.createElement("li");
        listItem.textContent = newItem;
        qDiv.appendChild(ulCreate);
        ulCreate.appendChild(listItem);
        listItem.addEventListener("click", (compare));
    })
    choiceD.forEach(function (newItem) {
        var listItem = document.createElement("li");
        listItem.textContent = newItem;
        qDiv.appendChild(ulCreate);
        ulCreate.appendChild(listItem);
        listItem.addEventListener("click", (compare));
    })
}

function compare(event) {
    var element = event.target;
    if (element.matches("li")) {
        var createDiv = document.createElement("div");
        createDiv.setAttribute("id", "createDiv");
        if (element.textContent === {{ questions[qIndex].correctAnswer }}) {
            createDiv.textContent = "Correct! The answer is:  " + {{ questions[qIndex].correctAnswer }};
        }
        else {
            createDiv.textContent = "Wrong! The correct answer is:  " + {{ questions[qIndex].correctAnswer }};
            score = score - 1
        }

    }
    qIndex++;

    if (qIndex >= {{ questions|length }}) {
        allDone();
        createDiv.textContent = "End of quiz!" + " " + "You got  " + score + " Correct!";
    } else {
        load(qIndex);
    }
    qDiv.appendChild(createDiv);

    function allDone() {
        qDiv.innerHTML = "";
        // Heading:
        var createH1 = document.createElement("h1");
        createH1.setAttribute("id", "createH1");
        createH1.textContent = "All Done!"

        qDiv.appendChild(createH1);

        // Paragraph
        var createP = document.createElement("p");
        createP.setAttribute("id", "createP");

        qDiv.appendChild(createP);

        // Label
        var createLabel = document.createElement("label");
        createLabel.setAttribute("id", "createLabel");
        createLabel.textContent = "Enter your initials: ";

        qDiv.appendChild(createLabel);

        // input
        var createInput = document.createElement("input");
        createInput.setAttribute("type", "text");
        createInput.setAttribute("id", "initials");
        createInput.textContent = "";

        qDiv.appendChild(createInput);

        // submit
        var createSubmit = document.createElement("button");
        createSubmit.setAttribute("type", "submit");
        createSubmit.setAttribute("id", "Submit");
        createSubmit.textContent = "Submit";

        qDiv.appendChild(createSubmit);

const element = document.getElementById("choice");
element.addEventListener("click", showResults);

            function showResults(element){
                if (questions[i][element] == questions[i][correctAnswer]) {
                    displayMessage("Correct!")
                }
                else {
                    displayMessage("Try Again")
                    score = score - 1
                }}

            {#submitButton.addEventListener('click', showResults);#}
        // })();
    </script>
    <style>
        #results {
            text-align: center; font-size: 35px
        }
    </style>

{% endblock %}